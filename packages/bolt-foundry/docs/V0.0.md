# Bolt Foundry SDK v0.0 Implementation Plan

## Overview

Version 0.0 establishes the foundational architecture for the Bolt Foundry SDK
with a generic, flexible spec system that compiles to OpenAI chat completion
format. This version focuses on creating the core building blocks - a simple
Spec class and an immutable SpecBuilder - that future versions will extend with
domain-specific functionality.

## Goals

| Goal              | Description                                           | Success Criteria                                                |
| ----------------- | ----------------------------------------------------- | --------------------------------------------------------------- |
| Core spec system  | Create flexible data structure for structured prompts | Spec class with value (string or Array<Spec>) and optional name |
| Immutable builder | Type-safe builder pattern for composing specs         | SpecBuilder with .spec(), .specs(), and .getSpecs() methods     |
| OpenAI rendering  | Compile specs to chat completion format               | Valid OpenAI API payloads with persona cards                    |
| Public API        | Client pattern for creating assistants                | boltFoundryClient.createAssistant() working end-to-end          |

## Anti-Goals

| Anti-Goal                 | Reason                                        |
| ------------------------- | --------------------------------------------- |
| Domain-specific builders  | Keep v0.0 generic to establish patterns first |
| Variable interpolation    | Focus on static content initially             |
| Production error handling | Get core concepts working first               |
| Multi-provider support    | Prove concept with OpenAI before expanding    |

## Technical Approach

We're using an immutable builder pattern inspired by our existing bfDb patterns.
Each builder method returns a new instance, enabling safe composition and
branching. The core Spec class is intentionally minimal - just a value (string
or nested specs) and optional name for grouping.

The `<⚡️persona_card⚡️>` XML format provides clear boundaries for LLMs while
avoiding collision with user content. This creates a visual and semantic
structure that both humans and AI can recognize.

## Components

| Status | Component         | Purpose                                      |
| ------ | ----------------- | -------------------------------------------- |
| [x]    | Spec class        | Base data structure for all prompt content   |
| [x]    | SpecBuilder       | Immutable builder for composing specs        |
| [x]    | makeSpecBuilder   | Factory function for type-safe builders      |
| [x]    | Assistant type    | Container for named assistant specifications |
| [x]    | OpenAI renderer   | Convert specs to chat completion format      |
| [ ]    | boltFoundryClient | Public API entry point                       |
| [ ]    | Package exports   | Clean public interface                       |

## Technical Decisions

| Decision           | Reasoning                                         | Alternatives Considered                      |
| ------------------ | ------------------------------------------------- | -------------------------------------------- |
| Immutable builders | Predictable state, safe sharing, functional style | Mutable builders (harder to reason about)    |
| Single Spec class  | Maximum flexibility, simple mental model          | Multiple spec types (premature optimization) |
| Factory functions  | Type inference, consistent instantiation          | Direct constructors (less flexible)          |
| XML persona cards  | Clear boundaries, no collision risk               | JSON blocks (could conflict with content)    |

## Next Steps

| Question                          | How to Explore                                       |
| --------------------------------- | ---------------------------------------------------- |
| How to structure public API?      | Create boltFoundryClient with createAssistant method |
| What's the minimal test coverage? | Write tests for assistant creation and rendering     |
| How to handle render options?     | Pass through to OpenAI format with defaults          |
| When to split builders.ts?        | After API stabilizes and patterns emerge             |

## File Structure

Current structure (intentionally minimal):

```
packages/bolt-foundry/
├── builders/
│   └── builders.ts          # All builder code in one file for now
├── bolt-foundry.ts          # Main exports
└── __tests__/
    └── builders.test.ts     # Builder tests
```
