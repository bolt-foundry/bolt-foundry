# Documentation system v0.1 implementation plan

## Overview

Get the docs online. That's it.

We're taking the blog's MDX setup (the one that actually worked) and making it
serve docs instead. Server-side rendering, SEO-friendly, fast loads. Start with
a flat list of docs - fancy navigation comes later.

## Goals

| Goal                  | Description                             | Success Criteria                      |
| --------------------- | --------------------------------------- | ------------------------------------- |
| Server-side rendering | Full HTML delivered on first request    | View source shows complete content    |
| SEO optimization      | Pages indexed by search engines         | Meta tags and content in initial HTML |
| Clean URLs            | User-friendly paths without extensions  | `/docs/getting-started` works         |
| MDX support           | Markdown enhanced with React components | Interactive examples render correctly |
| Fast builds           | Quick iteration during development      | < 30s rebuild with 20+ docs           |

## Anti-Goals

| Anti-Goal            | Reason                                   |
| -------------------- | ---------------------------------------- |
| Navigation sidebar   | Keep v0.1 simple, flat list is enough    |
| Search functionality | Not needed for initial launch            |
| Multiple versions    | Single version simplifies implementation |
| Database storage     | File-based approach worked well for blog |
| Dynamic updates      | Rebuild on deploy is acceptable          |

## Technical approach

Copy what worked from the blog, skip the complex parts:

1. **Build time**: Markdown → MDX → JavaScript modules
2. **GraphQL**: Simple types, no fancy Relay connections
   - Just arrays of docs
   - Skip the nodes/edges complexity
3. **Routes**: `/docs` shows README.md, `/docs/whatever` shows whatever.md
4. **Rendering**: Isograph handles SSR, we get SEO for free

The old docs system skipped SSR. That's why it's in the garbage.

## Components

| Status | Component              | Purpose                                 |
| ------ | ---------------------- | --------------------------------------- |
| [ ]    | MDX build pipeline     | Convert markdown to compiled JS modules |
| [ ]    | Document GraphQL types | Schema for doc metadata and content     |
| [ ]    | DocsPage component     | Isograph-based page component           |
| [ ]    | Document resolver      | GraphQL resolver to load compiled docs  |
| [ ]    | Route handlers         | `/docs` and `/docs/[slug]` routes       |
| [ ]    | Build integration      | Hook into bff build process             |

### Specific files to adapt (from blog analysis)

**Build pipeline:**

- Restore `infra/appBuild/contentBuild.ts` - processes markdown at build time
- Restore `infra/appBuild/plugins/contentPathRewriter.ts` - fixes import paths
- Update `infra/appBuild/appBuild.ts` - add MDX plugin back

**Data model:**

- Create `apps/bfDb/graphql/Doc.ts` - extends `GraphQLObjectBase` (not BfNode)
- Create `apps/bfDb/graphql/DocCollection.ts` - holds the list of docs
- Point it at `/docs/` not `/content/blog/`
- Parse frontmatter if it exists

**GraphQL/Isograph:**

- Create `apps/boltFoundry/entrypoints/EntrypointDocs.tsx` - lists all docs
- Create `apps/boltFoundry/entrypoints/EntrypointDoc.tsx` - shows one doc
- Wire them into the schema

**Components:**

- `DocsList.tsx` - shows the list
- `DocsListItem.tsx` - loads and renders MDX
- Copy the dynamic `import()` pattern from blog

**Routing:**

- Update `apps/boltFoundry/routes.ts`
- `/docs` → `EntrypointDocs`
- `/docs/:slug` → `EntrypointDoc`

## Technical Decisions

| Decision                | Reasoning                                      | Alternatives Considered              |
| ----------------------- | ---------------------------------------------- | ------------------------------------ |
| Reuse blog MDX pipeline | Proven to work, handles SSR correctly          | Building new from scratch            |
| File-based storage      | Simple, version controlled, no database needed | PostgreSQL with content table        |
| Build-time compilation  | Better performance, simpler runtime            | Runtime markdown parsing             |
| Isograph for SSR        | Already integrated, handles meta tags          | Next.js style SSR                    |
| Flat URL structure      | Simpler routing and implementation             | Nested paths matching file structure |

## Next Steps

| Question                                     | How to Explore                                            |
| -------------------------------------------- | --------------------------------------------------------- |
| ~~What's the exact blog MDX pipeline?~~      | ✓ Analyzed in tmp/all-blog-mdx-files.md                   |
| ~~Which files from tmp/garbage are needed?~~ | ✓ Identified specific files to restore above              |
| How to handle README.md specially?           | Look at blog index page handling                          |
| Meta tag requirements for docs?              | Review SEO best practices for technical documentation     |
| How does the current build work?             | Check if contentBuild is still referenced in build.bff.ts |
| Where are the blog models now?               | Verify if BfBlogPost still exists in current codebase     |
