#!/bin/bash

# Check for --upgrade or --update flags
if [[ "$1" == "--upgrade" ]] || [[ "$1" == "--update" ]]; then
    echo "Upgrading Claude Code..."
    deno install --allow-scripts=npm:@anthropic-ai/claude-code npm:@anthropic-ai/claude-code
    echo "Claude Code has been upgraded successfully!"
    exit 0
fi

# Always install latest version before launching
deno install --allow-scripts=npm:@anthropic-ai/claude-code npm:@anthropic-ai/claude-code > /dev/null 2>&1

# Run Claude Code normally with AI context environment variable
BFT_AI_CONTEXT=true deno run -A npm:@anthropic-ai/claude-code "$@"
